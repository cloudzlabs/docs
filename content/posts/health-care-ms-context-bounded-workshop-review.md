---
date: "2018-02-26T17:52:54+09:00"
title: "MSA 에서 유비쿼터스 언어의 중요성"
authors: [jisangYun]
categories:
  - posts
tags:
  - Ubiquitous
  - HealthCare
  - Mobile
  - Bounded Context
  - MS 분리 워크샵
  - Domain Driven Design
cover:
  image: "/docs/images/health-care-ms-context-bounded-workshop-review/health3.png"
  caption: ""
description: ""
draft: false
---

Health-Care 관련 시스템 - MS 분리 워크샵 이후 Cloud서비스개발팀 박준 팀장님의 Review 내용을 옮긴 글입니다.

## 기존의 문제점 - 언어의 문제

Health-Care Application 요구사항에 의거한 용어들에 대해 끊임없는 질의해본다.

- 보상/혜택
  - Reward가 사용자에게 주어지면 그게 사용자 입장에서는? Item인가 Reward인가?
  - 운동을 안해서 주는 경고도 Reward인가?
  - 내가 운동을 많이 했다고 선물이 아니라 칭찬메시지가 오는 것도 Reward인가?
  - 친구가 나를 역전했다고 알려주는 것이 Reward인가?
- 챌린지
  - 챌린지와 목표의 차이는?
  - 챌린지가 이벤트와 다른 것인가?
- 랭킹
  - 랭킹의 종류는 유한한가? 무한한가?
    - 메이저리그를 보면 무한한 수의 랭킹이 있다. ex) 아시아 투수 중 최다승 투수 등
  - 그것이 랭킹인가 통계인가?
- 포인트
  - 포인트가 보상인가?
  - 포인트가 경험치인가?
  - 운동량과 포인트는 누구에게나 동일한 비율로 적재되는가?
- 리워드 지갑/혜택 저장
  - 리워드를 지갑에 넣는 순간 Item 아닌가?
- 활동/액티비티
  - 걸음 등 운동만 활동인가?
  - 가입도 활동으로 보는가?
  - 쿠폰 사용도 활동으로 보는가?
  - 친구 맺기 등 소셜 기능은 활동인가?
- 이벤트
  - 행사가 이벤트인가?
  - 챌린지를 집단으로 한다면 챌린지인가 이벤트인가?
- 게임 기능
  - 게임 기능이 포함되어 있다고 하는데, 위 모든 기능이 결국은 게임 아닌가?

문제점 투성이다.

이 이름들로 API를 구현하고 DB Table을 정의한다면, 향후 요구사항 변경 시 걷잡을 수 없는 스파게티 코드 시스템이 될 것만 같다.

### 유비쿼터스 언어 다듬기

Health-Care Application이라는 컨텍스트는 게임과 유사하다.

![game](/docs/images/health-care-ms-context-bounded-workshop-review/health1.jpg)

게임에서 캐릭터가 활동하는 것이 실제 사람으로 바뀌었을 뿐이다.

- 캐릭터 액티비티 로그 수집
- 이벤트 처리
- 아이템 관리
- 소셜 관리
- 회원 관리
- 관리자 기능
- 통계/랭킹

Bounded Context와 용어를 명확하게 규정하고 책임을 제한할 필요가 있다.

### 조직 측면 - Bounded Context 내 책임을 제한하고, 자율성(Autonomy)을 더 강화하기

각 Bounded Context는 밖의 세상을 알지 못한다.

Health-Care Application에서 일어나고 있는 일들을 Bounded Context 내에서 바라보면 아래와 같이 바라보게 된다. 이 용어들은 철저하게 Bounded Context 내에서 유비쿼터스 용어가 제한되어야 하며, 밖의 세상에 관여되어서는 안된다.

예를 들면 상품관리 팀에서 걸음 수 미션 달성 따위를 얘기하면 안된다는 것이다.

- 액티비티 로그 수집 팀
  - 무언가 이벤트가 발생하면 효율적인 저장소에 기록한다.
  - 저장소는 Scalabable 하고 절대로 장애가 나서는 안된다.
  - 기록도 많고 쿼리도  많고, 특히 시계열/기간에 대한 쿼리가 많다.
  - 성능이 중요하다.
- 통계/랭킹 팀
  - 순위를 매기거나 간략 정보를 요약해서 보여주는 등 통계 Job 들을 만든다.
  - 새로운 Job을 추가하는 요구사항이 많이 들어오거나 요약 정보를 만들어달라는 요구사항이 늘어나면 피곤하다.
  - 이 조직은 어떻게 해야할지 고민이다.
- 이벤트 처리 팀
  - 마케팅 관련 조직이다.
  - 주어진 예산 내에서 어떤 조건의 고객 세그먼트에게 마케팅/보상을 할지 결정한다.
  - 해당 조건을 가입 3개월 축하, 챌린지 달성 축하, 친구와 함께하는 이벤트 1등 달성 등이다.
  - 조건식을 관리하고 유효기간을 지정한다.
- 상품 기획/관리 팀
  - 바우처, 쿠폰 등을 구입하고 재고관리를 한다.
  - 누군가 반출을 요청하면 소모량을 기록하고 재고를 줄인다.
  - 실제 바우처, 쿠폰이 사용되었는지 제휴사와 연동하고 사용되었으면 완료 기록을 한다.
- 소셜 기능 팀
  - 회원 관리가 되는 미니 SNS 시스템을 만든다.
- 관리자 기능 팀
  - 메뉴 관리, 코드 관리, 메세지 관리 등 공통 기능을 만든다.
  - 자칭 BaaS(Backend as a Service) 팀이라고 부른다.

**요기까지 끝!**

## 나의 감상
프로젝트에서 언어의 중요성은 아무리 강조해도 모자라다.

특히 MSA 를 적용한 개발팀은 언어 정의(Definition)에 따라 업무 범위와 책임이 구별되는 만큼 중요하게 생각해야 한다. 

모두가 함께 쓰는 공통 언어 + 중의적 의미가 제거된 명확한 언어 + 번역이 필요없는 언어를 추구하자.


